!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return r[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},t.parcelRequired7c6=i),i.register("gD1JV",(function(e,t){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return r(e,t)}})),i.register("8slrw",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return e}})),i.register("7AJDX",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}})),i.register("ifqQW",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),i.register("auk6i",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(!e)return;if("string"==typeof e)return n.default(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n.default(e,t)};var r,n=(r=i("8NIkP"))&&r.__esModule?r:{default:r}})),i.register("8NIkP",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}})),i.register("kMC0W",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return n.default(e)};var r,n=(r=i("8NIkP"))&&r.__esModule?r:{default:r}})),i.register("8CtQK",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),i.register("aTHs7",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}})),i.register("fVNic",(function(e,t){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return r(e)}})),i.register("jmhxu",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return!t||"object"!==n.default(t)&&"function"!=typeof t?r.default(e):t};var r=o(i("ds8z5")),n=o(i("l5bVx"));function o(e){return e&&e.__esModule?e:{default:e}}})),i.register("ds8z5",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}})),i.register("l5bVx",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return e&&e.constructor===Symbol?"symbol":typeof e}}));var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e};var a=[{id:1,lat:50.3864813,lng:30.4610184},{id:2,lat:50.3893584,lng:30.4744418},{id:3,lat:50.3766632,lng:30.4545341},{id:4,lat:50.3871685,lng:30.4633948},{id:5,lat:50.3839428,lng:30.4448406},{id:6,lat:50.3950753,lng:30.5020464},{id:7,lat:50.3932314,lng:30.4851096},{id:8,lat:50.3932962,lng:30.4808875},{id:9,lat:50.3850642,lng:30.4800686},{id:10,lat:50.3852944,lng:30.4568793},{id:11,lat:50.383335,lng:30.4582703}],u=[{id:1,title:"Вільямса, 9",image:"https://images.pexels.com/photos/271624/pexels-photo-271624.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:2,title:"Ломоносова, 38",image:"https://images.pexels.com/photos/1643383/pexels-photo-1643383.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:3,title:"Касьяна, 20",image:"https://images.pexels.com/photos/667838/pexels-photo-667838.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:4,title:"Мейтуса, 10",image:"https://images.pexels.com/photos/245208/pexels-photo-245208.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:5,title:"Луценка, 11",image:"https://images.pexels.com/photos/259962/pexels-photo-259962.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:6,title:"Васильківська, 11",image:"https://images.pexels.com/photos/439227/pexels-photo-439227.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:7,title:"Васильківська, 34",image:"https://images.pexels.com/photos/1669799/pexels-photo-1669799.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:8,title:"Максимовича, 4",image:"https://images.pexels.com/photos/1571459/pexels-photo-1571459.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:9,title:"Васильківська, 53",image:"https://images.pexels.com/photos/1648771/pexels-photo-1648771.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:10,title:"Вільямса, 11",image:"https://images.pexels.com/photos/271743/pexels-photo-271743.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"},{id:11,title:"Конєва, 10",image:"https://images.pexels.com/photos/265004/pexels-photo-265004.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",description:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sint tempore quidem aliquam, vero itaque architecto qui minima hic saepe placeat?"}],l=function t(){"use strict";var r=this;e(o)(this,t),e(s)(this,"initModel",(function(){null===JSON.parse(localStorage.getItem("points"))&&localStorage.setItem("points",JSON.stringify(a)),null===JSON.parse(localStorage.getItem("apartments"))&&localStorage.setItem("apartments",JSON.stringify(u))})),e(s)(this,"getAllPoints",(function(){return JSON.parse(localStorage.getItem("points"))})),e(s)(this,"getLastPointId",(function(){var e=JSON.parse(localStorage.getItem("points"));return e[e.length-1].id})),e(s)(this,"getAllApartments",(function(){return JSON.parse(localStorage.getItem("apartments"))})),e(s)(this,"getApartmentById",(function(e){var t=JSON.parse(localStorage.getItem("apartments"));return[t[t.findIndex((function(t){return t.id===e}))]]})),e(s)(this,"getApartmentsByIdArr",(function(e){return JSON.parse(localStorage.getItem("apartments")).filter((function(t){return e.includes(t.id)}))})),e(s)(this,"getVisiblePointsId",(function(e){return JSON.parse(localStorage.getItem("points")).filter(p(e)).map(c)})),e(s)(this,"initBuffer",(function(e,t){var n=t.lat,i=t.lng;r.bufferObj.status="PREPAING",r.bufferObj.id=e+1,r.bufferObj.lat=n,r.bufferObj.lng=i})),e(s)(this,"addApartmentToBuffer",(function(e){var t=e.title,n=e.image,i=e.description;r.bufferObj.status="READY",r.bufferObj.title=t,r.bufferObj.image=n,r.bufferObj.description=i})),e(s)(this,"addNewApartment",(function(e){var t=e.id,r=e.lat,n=e.lng,i=e.title,o=e.image,s=e.description,a=JSON.parse(localStorage.getItem("points")),u=JSON.parse(localStorage.getItem("apartments"));a.push({id:t,lat:r,lng:n}),u.push({id:t,title:i,image:o,description:s}),localStorage.setItem("points",JSON.stringify(a)),localStorage.setItem("apartments",JSON.stringify(u))})),e(s)(this,"bufferObj",{status:"EMPTY",id:null,lat:null,lng:null,title:"",image:"",description:""})},c=function(e){return e.id},p=function(e){var t=e.south,r=e.north,n=e.west,i=e.east;return function(e){var o=e.lat,s=e.lng;return s>n&&s<i&&o>t&&o<r}},d={};function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(e,t,r){t&&f(e.prototype,t);r&&f(e,r);return e};var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g.default(e,t)};var h,g=(h=i("gD1JV"))&&h.__esModule?h:{default:h};var v={};Object.defineProperty(v,"__esModule",{value:!0}),v.default=function(e,t){return y.default(e)||_.default(e,t)||x.default(e,t)||b.default()};var y=k(i("8slrw")),_=k(i("7AJDX")),b=k(i("ifqQW")),x=k(i("auk6i"));function k(e){return e&&e.__esModule?e:{default:e}}var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.default=function(e){return S.default(e)||M.default(e)||P.default(e)||O.default()};var S=A(i("kMC0W")),M=A(i("7AJDX")),O=A(i("8CtQK")),P=A(i("auk6i"));function A(e){return e&&e.__esModule?e:{default:e}}var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.default=function(e){var t=E.default();return function(){var r,n=L.default(e);if(t){var i=L.default(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return q.default(this,r)}};var E=I(i("aTHs7")),L=I(i("fVNic")),q=I(i("jmhxu"));function I(e){return e&&e.__esModule?e:{default:e}}var C;function N(e,t,r,n,i,o){if(!(i-n<=r)){var s=n+i>>1;T(e,t,s,n,i,o%2),N(e,t,r,n,s-1,o+1),N(e,t,r,s+1,i,o+1)}}function T(e,t,r,n,i,o){for(;i>n;){if(i-n>600){var s=i-n+1,a=r-n+1,u=Math.log(s),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(s-l)/s)*(a-s/2<0?-1:1);T(e,t,r,Math.max(n,Math.floor(r-a*l/s+c)),Math.min(i,Math.floor(r+(s-a)*l/s+c)),o)}var p=t[2*r+o],d=n,f=i;for(z(e,t,n,r),t[2*i+o]>p&&z(e,t,n,i);d<f;){for(z(e,t,d,f),d++,f--;t[2*d+o]<p;)d++;for(;t[2*f+o]>p;)f--}t[2*n+o]===p?z(e,t,n,f):z(e,t,++f,i),f<=r&&(n=f+1),r<=f&&(i=f-1)}}function z(e,t,r,n){Z(e,r,n),Z(t,2*r,2*n),Z(t,2*r+1,2*n+1)}function Z(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function F(e,t,r,n,i,o,s){for(var a,u,l=[0,e.length-1,0],c=[];l.length;){var p=l.pop(),d=l.pop(),f=l.pop();if(d-f<=s)for(var m=f;m<=d;m++)a=t[2*m],u=t[2*m+1],a>=r&&a<=i&&u>=n&&u<=o&&c.push(e[m]);else{var h=Math.floor((f+d)/2);a=t[2*h],u=t[2*h+1],a>=r&&a<=i&&u>=n&&u<=o&&c.push(e[h]);var g=(p+1)%2;(0===p?r<=a:n<=u)&&(l.push(f),l.push(h-1),l.push(g)),(0===p?i>=a:o>=u)&&(l.push(h+1),l.push(d),l.push(g))}}return c}function R(e,t,r,n,i,o){for(var s=[0,e.length-1,0],a=[],u=i*i;s.length;){var l=s.pop(),c=s.pop(),p=s.pop();if(c-p<=o)for(var d=p;d<=c;d++)B(t[2*d],t[2*d+1],r,n)<=u&&a.push(e[d]);else{var f=Math.floor((p+c)/2),m=t[2*f],h=t[2*f+1];B(m,h,r,n)<=u&&a.push(e[f]);var g=(l+1)%2;(0===l?r-i<=m:n-i<=h)&&(s.push(p),s.push(f-1),s.push(g)),(0===l?r+i>=m:n+i>=h)&&(s.push(f+1),s.push(c),s.push(g))}}return a}function B(e,t,r,n){var i=e-r,o=t-n;return i*i+o*o}C=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r};var J,G=function(e){return e[0]},D=function(e){return e[1]},V=function(){"use strict";function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Float64Array;e(o)(this,t),this.nodeSize=s,this.points=r;for(var u=r.length<65536?Uint16Array:Uint32Array,l=this.ids=new u(r.length),c=this.coords=new a(2*r.length),p=0;p<r.length;p++)l[p]=p,c[2*p]=n(r[p]),c[2*p+1]=i(r[p]);N(l,c,s,0,l.length-1,0)}return e(d)(t,[{key:"range",value:function(e,t,r,n){return F(this.ids,this.coords,e,t,r,n,this.nodeSize)}},{key:"within",value:function(e,t,r){return R(this.ids,this.coords,e,t,r,this.nodeSize)}}]),t}(),U={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},H=Math.fround||(J=new Float32Array(1),function(e){return J[0]=+e,J[0]}),K=function(){"use strict";function t(r){e(o)(this,t),this.options=ee(Object.create(U),r),this.trees=new Array(this.options.maxZoom+1)}return e(d)(t,[{key:"load",value:function(t){var r=this.options,n=r.log,i=r.minZoom,o=r.maxZoom,s=r.nodeSize;n&&console.time("total time");var a="prepare ".concat(t.length," points");n&&console.time(a),this.points=t;for(var u,l,c,p,d,f=[],m=0;m<t.length;m++)t[m].geometry&&f.push((u=t[m],l=m,c=void 0,p=void 0,d=void 0,c=e(v)(u.geometry.coordinates,2),p=c[0],d=c[1],{x:H(Y(p)),y:H($(d)),zoom:1/0,index:l,parentId:-1}));this.trees[o+1]=new V(f,te,re,s,Float32Array),n&&console.timeEnd(a);for(var h=o;h>=i;h--){var g=+Date.now();f=this._cluster(f,h),this.trees[h]=new V(f,te,re,s,Float32Array),n&&console.log("z%d: %d clusters in %dms",h,f.length,+Date.now()-g)}return n&&console.timeEnd("total time"),this}},{key:"getClusters",value:function(e,t){var r=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){var s=this.getClusters([r,n,180,o],t),a=this.getClusters([-180,n,i,o],t);return s.concat(a)}var u=this.trees[this._limitZoom(t)],l=u.range(Y(r),$(o),Y(i),$(n)),c=[],p=!0,d=!1,f=void 0;try{for(var m,h=l[Symbol.iterator]();!(p=(m=h.next()).done);p=!0){var g=m.value,v=u.points[g];c.push(v.numPoints?X(v):this.points[v.index])}}catch(e){d=!0,f=e}finally{try{p||null==h.return||h.return()}finally{if(d)throw f}}return c}},{key:"getChildren",value:function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);var o=i.points[t];if(!o)throw new Error(n);var s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=i.within(o.x,o.y,s),u=[],l=!0,c=!1,p=void 0;try{for(var d,f=a[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var m=d.value,h=i.points[m];h.parentId===e&&u.push(h.numPoints?X(h):this.points[h.index])}}catch(e){c=!0,p=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw p}}if(0===u.length)throw new Error(n);return u}},{key:"getLeaves",value:function(e,t,r){t=t||10,r=r||0;var n=[];return this._appendLeaves(n,e,t,r,0),n}},{key:"getTile",value:function(e,t,r){var n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,s=o.extent,a=o.radius/s,u=(r-a)/i,l=(r+1+a)/i,c={features:[]};return this._addTileFeatures(n.range((t-a)/i,u,(t+1+a)/i,l),n.points,t,r,i,c),0===t&&this._addTileFeatures(n.range(1-a/i,u,1,l),n.points,i,r,i,c),t===i-1&&this._addTileFeatures(n.range(0,u,a/i,l),n.points,-1,r,i,c),c.features.length?c:null}},{key:"getClusterExpansionZoom",value:function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}},{key:"_appendLeaves",value:function(e,t,r,n,i){var o=this.getChildren(t),s=!0,a=!1,u=void 0;try{for(var l,c=o[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var p=l.value,d=p.properties;if(d&&d.cluster?i+d.point_count<=n?i+=d.point_count:i=this._appendLeaves(e,d.cluster_id,r,n,i):i<n?i++:e.push(p),e.length===r)break}}catch(e){a=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(a)throw u}}return i}},{key:"_addTileFeatures",value:function(e,t,r,n,i,o){var s=!0,a=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var p=t[l.value],d=p.numPoints,f=void 0,m=void 0,h=void 0;if(d)f=W(p),m=p.x,h=p.y;else{var g=this.points[p.index];f=g.properties,m=Y(g.geometry.coordinates[0]),h=$(g.geometry.coordinates[1])}var v={type:1,geometry:[[Math.round(this.options.extent*(m*i-r)),Math.round(this.options.extent*(h*i-n))]],tags:f},y=void 0;d?y=p.id:this.options.generateId?y=p.index:this.points[p.index].id&&(y=this.points[p.index].id),void 0!==y&&(v.id=y),o.features.push(v)}}catch(e){a=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(a)throw u}}}},{key:"_limitZoom",value:function(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}},{key:"_cluster",value:function(e,t){for(var r=[],n=this.options,i=n.radius,o=n.extent,s=n.reduce,a=n.minPoints,u=i/(o*Math.pow(2,t)),l=0;l<e.length;l++){var c=e[l];if(!(c.zoom<=t)){c.zoom=t;var p=this.trees[t+1],d=p.within(c.x,c.y,u),f=c.numPoints||1,m=f,h=!0,g=!1,v=void 0;try{for(var y,_=d[Symbol.iterator]();!(h=(y=_.next()).done);h=!0){var b=y.value,x=p.points[b];x.zoom>t&&(m+=x.numPoints||1)}}catch(e){g=!0,v=e}finally{try{h||null==_.return||_.return()}finally{if(g)throw v}}if(m>f&&m>=a){var k=c.x*f,w=c.y*f,S=s&&f>1?this._map(c,!0):null,M=(l<<5)+(t+1)+this.points.length,O=!0,P=!1,A=void 0;try{for(var j,E=d[Symbol.iterator]();!(O=(j=E.next()).done);O=!0){var L=j.value,q=p.points[L];if(!(q.zoom<=t)){q.zoom=t;var I=q.numPoints||1;k+=q.x*I,w+=q.y*I,q.parentId=M,s&&(S||(S=this._map(c,!0)),s(S,this._map(q)))}}}catch(e){P=!0,A=e}finally{try{O||null==E.return||E.return()}finally{if(P)throw A}}c.parentId=M,r.push(Q(k/m,w/m,M,m,S))}else{r.push(c);var C=!0,N=!1,T=void 0;if(m>1)try{for(var z,Z=d[Symbol.iterator]();!(C=(z=Z.next()).done);C=!0){var F=z.value,R=p.points[F];R.zoom<=t||(R.zoom=t,r.push(R))}}catch(e){N=!0,T=e}finally{try{C||null==Z.return||Z.return()}finally{if(N)throw T}}}}}return r}},{key:"_getOriginId",value:function(e){return e-this.points.length>>5}},{key:"_getOriginZoom",value:function(e){return(e-this.points.length)%32}},{key:"_map",value:function(e,t){if(e.numPoints)return t?ee({},e.properties):e.properties;var r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?ee({},n):n}}]),t}();function Q(e,t,r,n,i){return{x:H(e),y:H(t),zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function X(e){return{type:"Feature",id:e.id,properties:W(e),geometry:{type:"Point",coordinates:[(n=e.x,360*(n-.5)),(t=e.y,r=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var t,r,n}function W(e){var t=e.numPoints,r=t>=1e4?"".concat(Math.round(t/1e3),"k"):t>=1e3?"".concat(Math.round(t/100)/10,"k"):t;return ee(ee({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function Y(e){return e/360+.5}function $(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function ee(e,t){for(var r in t)e[r]=t[r];return e}function te(e){return e.x}function re(e){return e.y}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function ne(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}var ie=function(){"use strict";function t(r){var n=r.markers,i=r.position;e(o)(this,t),this.markers=n,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}return e(d)(t,[{key:"bounds",get:function(){if(0!==this.markers.length||this._position)return this.markers.reduce((function(e,t){return e.extend(t.getPosition())}),new google.maps.LatLngBounds(this._position,this._position))}},{key:"position",get:function(){return this._position||this.bounds.getCenter()}},{key:"count",get:function(){return this.markers.filter((function(e){return e.getVisible()})).length}},{key:"push",value:function(e){this.markers.push(e)}},{key:"delete",value:function(){this.marker&&(this.marker.setMap(null),delete this.marker),this.markers.length=0}}]),t}(),oe=function(){"use strict";function t(r){var n=r.maxZoom,i=void 0===n?16:n;e(o)(this,t),this.maxZoom=i}return e(d)(t,[{key:"noop",value:function(e){var t=e.markers;return se(t)}}]),t}(),se=function(e){return e.map((function(e){return new ie({position:e.getPosition(),markers:[e]})}))},ae=function(t){"use strict";e(m)(n,t);var r=e(j)(n);function n(t){var i;e(o)(this,n);var s=t.maxZoom,a=t.radius,u=void 0===a?60:a,l=ne(t,["maxZoom","radius"]);return(i=r.call(this,{maxZoom:s})).superCluster=new K(Object.assign({maxZoom:i.maxZoom,radius:u},l)),i.state={zoom:null},i}return e(d)(n,[{key:"calculate",value:function(t){var r=!1;if(!e(C)(t.markers,this.markers)){r=!0,this.markers=e(w)(t.markers);var n=this.markers.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.getPosition().lng(),e.getPosition().lat()]},properties:{marker:e}}}));this.superCluster.load(n)}var i={zoom:t.map.getZoom()};return r||this.state.zoom>this.maxZoom&&i.zoom>this.maxZoom||(r=r||!e(C)(this.state,i)),this.state=i,r&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:r}}},{key:"cluster",value:function(e){var t=e.map;return this.superCluster.getClusters([-180,-90,180,90],Math.round(t.getZoom())).map(this.transformCluster.bind(this))}},{key:"transformCluster",value:function(t){var r=t.geometry,n=e(v)(r.coordinates,2),i=n[0],o=n[1],s=t.properties;if(s.cluster)return new ie({markers:this.superCluster.getLeaves(s.cluster_id,1/0).map((function(e){return e.properties.marker})),position:new google.maps.LatLng({lat:o,lng:i})});var a=s.marker;return new ie({markers:[a],position:a.getPosition()})}}]),n}(oe),ue=function t(r,n){"use strict";var i,s;e(o)(this,t),this.markers={sum:r.length};var a=n.map((function(e){return e.count})),u=a.reduce((function(e,t){return e+t}),0);this.clusters={count:n.length,markers:{mean:u/n.length,sum:u,min:(i=Math).min.apply(i,e(w)(a)),max:(s=Math).max.apply(s,e(w)(a))}}},le=function(){"use strict";function t(){e(o)(this,t)}return e(d)(t,[{key:"render",value:function(e,t){var r=e.count,n=e.position,i=r>Math.max(10,t.clusters.markers.mean)?"#ff0000":"#0000ff",o=window.btoa('\n  <svg fill="'.concat(i,'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240">\n    <circle cx="120" cy="120" opacity=".6" r="70" />\n    <circle cx="120" cy="120" opacity=".3" r="90" />\n    <circle cx="120" cy="120" opacity=".2" r="110" />\n  </svg>'));return new google.maps.Marker({position:n,icon:{url:"data:image/svg+xml;base64,".concat(o),scaledSize:new google.maps.Size(45,45)},label:{text:String(r),color:"rgba(255,255,255,0.9)",fontSize:"12px"},title:"Cluster of ".concat(r," markers"),zIndex:Number(google.maps.Marker.MAX_ZINDEX)+r})}}]),t}();var ce,pe,de=function t(){"use strict";e(o)(this,t),function(e,t){for(var r in t.prototype)e.prototype[r]=t.prototype[r]}(t,google.maps.OverlayView)};(pe=ce||(ce={})).CLUSTERING_BEGIN="clusteringbegin",pe.CLUSTERING_END="clusteringend",pe.CLUSTER_CLICK="click";var fe=function(e,t,r){r.fitBounds(t.bounds)},me=function(t){"use strict";e(m)(n,t);var r=e(j)(n);function n(t){var i,s=t.map,a=t.markers,u=void 0===a?[]:a,l=t.algorithm,c=void 0===l?new ae({}):l,p=t.renderer,d=void 0===p?new le:p,f=t.onClusterClick,m=void 0===f?fe:f;return e(o)(this,n),(i=r.call(this)).markers=e(w)(u),i.clusters=[],i.algorithm=c,i.renderer=d,i.onClusterClick=m,s&&i.setMap(s),i}return e(d)(n,[{key:"addMarker",value:function(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}},{key:"addMarkers",value:function(e,t){var r=this;e.forEach((function(e){r.addMarker(e,!0)})),t||this.render()}},{key:"removeMarker",value:function(e,t){var r=this.markers.indexOf(e);return-1!==r&&(e.setMap(null),this.markers.splice(r,1),t||this.render(),!0)}},{key:"removeMarkers",value:function(e,t){var r=this,n=!1;return e.forEach((function(e){n=r.removeMarker(e,!0)||n})),n&&!t&&this.render(),n}},{key:"clearMarkers",value:function(e){this.markers.length=0,e||this.render()}},{key:"render",value:function(){var e=this.getMap();if(e instanceof google.maps.Map&&this.getProjection()){google.maps.event.trigger(this,ce.CLUSTERING_BEGIN,this);var t=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()}),r=t.clusters,n=t.changed;(n||null==n)&&(this.reset(),this.clusters=r,this.renderClusters()),google.maps.event.trigger(this,ce.CLUSTERING_END,this)}}},{key:"onAdd",value:function(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}},{key:"onRemove",value:function(){google.maps.event.removeListener(this.idleListener),this.reset()}},{key:"reset",value:function(){this.markers.forEach((function(e){return e.setMap(null)})),this.clusters.forEach((function(e){return e.delete()})),this.clusters=[]}},{key:"renderClusters",value:function(){var e=this,t=new ue(this.markers,this.clusters),r=this.getMap();this.clusters.forEach((function(n){if(1===n.markers.length)n.marker=n.markers[0];else{var i=e;n.marker=e.renderer.render(n,t),e.onClusterClick&&n.marker.addListener("click",(function(e){google.maps.event.trigger(i,ce.CLUSTER_CLICK,n),i.onClusterClick(e,n,r)}))}n.marker.setMap(r)}))}}]),n}(de);function he(e){var t=new google.maps.Map(e,{zoom:16,center:{lat:50.3864813,lng:30.4610184},mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.TOP_CENTER},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},scaleControl:!0,streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},fullscreenControl:!0}),r=[];t.addListener("bounds_changed",(function(){for(var e=0;e<r.length;e++)"bounds_changed"===r[e].eventName&&r[e].listener(t.getBounds().toJSON())})),setTimeout((function(){console.log("get bounds",t.getBounds().toJSON())}),3e3);return{addPoints:function(e){var r=e.map((function(e){var r=e.id,n=e.lat,i=e.lng,o=r.toString(),s=new google.maps.Marker({position:{lat:n,lng:i},label:o});return s.addListener("click",(function(e){t.setZoom(18),t.setCenter(s.position),document.querySelector("[data-id='".concat(s.label,"']")).scrollIntoView(!0)})),s}));new me({markers:r,map:t})},findNewPoints:function(e){return new Promise((function(r,n){new google.maps.places.PlacesService(t).findPlaceFromQuery(e,(function(e,i){if(i===google.maps.places.PlacesServiceStatus.OK){!function(e){if(!e.geometry||!e.geometry.location)return;new google.maps.Marker({map:t,position:e.geometry.location})}(e[0]);var o={lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng()};t.setCenter(e[0].geometry.location),r(o)}else n(i)}))}))},zoomTo:function(){},addEventListener:function(e,t){r.push({eventName:e,listener:t})},removeEventListener:function(e,t){}}}var ge=function t(r){"use strict";var n=this;e(o)(this,t),e(s)(this,"itemsGalleryEl",""),e(s)(this,"renderItemsGallery",(function(e){return e.map((function(e){return'\n    <li class="item" data-id="'.concat(e.id,'">\n    <img class="item__img" src="').concat(e.image,'" alt="" />\n    <div class="item__details">\n      <h3 class="item__title">').concat(e.title,'</h3>\n      <p class="item__description">').concat(e.description,"</p>\n    </div>\n  </li>\n    ")})).join("")})),e(s)(this,"showApartments",(function(e){n.itemsGalleryEl.innerHTML=n.renderItemsGallery(e)})),e(s)(this,"hideGallery",(function(){n.itemsGalleryEl.classList.add("invisible")})),e(s)(this,"openGallery",(function(){n.itemsGalleryEl.classList.remove("invisible")})),this.itemsGalleryEl=document.querySelector(r)},ve=function t(r){"use strict";var n=this;e(o)(this,t),e(s)(this,"rootEl",""),e(s)(this,"ref",{inputAddress:"",inputImageLink:"",inputDescripton:"",buttonSearch:"",stepAdd:[]}),e(s)(this,"renderFormToAddNewApartment",(function(e,t){var r=n;n.rootEl.innerHTML='\n<div class="form__wrap">\n  <h3 class="form__title">Додайте новий об\'єкт</h3>\n  <form class="form__body">\n    <label class="form__label">\n      <span class="form__text">Адреса</span>\n      <input class="form__field" type="text" name="title" placeholder="назва вулиці, № будинку" />\n    </label>\n\n    <label class="form__label">\n      <span class="form__text invisible" option="stepAdd">Посилання на фото</span>\n      <input class="form__field invisible" type="text" name="image" option="stepAdd" placeholder="посилання на фото" />\n    </label>\n\n    <label class="form__label ">\n      <span class="form__text invisible" option="stepAdd">Опис</span>\n      <textarea\n        class="form__field form__field--textarea invisible"\n        name="description"\n        option="stepAdd"\n        placeholder="опис об\'єкту"\n        cols="30"\n        rows="10"\n      ></textarea>\n    </label>\n    <button class="form__button form__button--search" option=\'step1\'>Знайти адресу</button>\n    <button class="form__button form__button--save invisible" type="submit" option=\'stepAdd\'>Додати</button>\n    <div class=\'form__error\'>\n    <p class=\'error__text--not-found invisible\'>Об\'єкт не знайдено. Спробуйте ще</p>\n    <p class=\'error__text--empty-fields invisible\'>Заповніть всі поля</p>\n    </div>\n\n  </form>\n</div>\n',n.ref.inputAddress=n.rootEl.querySelector('input[name="title"]'),n.ref.inputImageLink=n.rootEl.querySelector('input[name="image"]'),n.ref.inputDescripton=n.rootEl.querySelector('[name="description"]'),n.ref.buttonSearch=n.rootEl.querySelector(".form__button--search"),n.ref.stepAdd=n.rootEl.querySelectorAll('[option="stepAdd"]'),n.ref.inputAddress.addEventListener("focus",(function(){r.ref.inputAddress.value="",r.hideErrorSearch()})),n.rootEl.querySelector(".form__button--search").addEventListener("click",(function(t){t.preventDefault();var n=r.ref.inputAddress.value;e(n)})),n.rootEl.querySelector(".form__body").addEventListener("submit",(function(e){e.preventDefault();var r=e.currentTarget.elements.title.value,n=e.currentTarget.elements.image.value,i=e.currentTarget.elements.description.value;t({title:r,image:n,description:i})}))})),e(s)(this,"openFormAfterSearch",(function(){n.ref.buttonSearch.classList.add("invisible"),n.ref.stepAdd.forEach((function(e){return e.classList.remove("invisible")}))})),e(s)(this,"hideFormAfterSearch",(function(){n.ref.inputAddress.value="",n.ref.inputImageLink.value="",n.ref.inputDescripton.value="",n.ref.buttonSearch.classList.remove("invisible"),n.ref.stepAdd.forEach((function(e){return e.classList.add("invisible")}))})),e(s)(this,"hideForm",(function(){n.rootEl.classList.add("invisible")})),e(s)(this,"openForm",(function(){n.rootEl.classList.remove("invisible")})),e(s)(this,"hideErrorSearch",(function(){n.rootEl.querySelector(".error__text--not-found").classList.add("invisible")})),e(s)(this,"showErrorSearch",(function(){n.rootEl.querySelector(".error__text--not-found").classList.remove("invisible")})),this.rootEl=document.querySelector(r),this.hideForm()},ye=function(){"use strict";function t(r){var n=this;e(o)(this,t),e(s)(this,"root",""),e(s)(this,"rootMap",""),e(s)(this,"rootGallery",""),e(s)(this,"rootForm",""),e(s)(this,"initApp",(function(){document.querySelector(n.root).innerHTML='\n        <header class="container">\n        <div class="header__wrap">\n            <div class="header__logo">\n                <a class="header__link" href="https://www.gup.ua/">\n                <img\n                    class="header__img"\n                    src="https://www.gup.ua/images/logo-ua-razom.svg"\n                    alt="Лого порталу GUP: сервіс прокату і оренди"\n                /></a>\n            </div>\n            <div class="header__menu">\n                <button type="button" class="header__btn" id="add-bulletin">\n                <span>Здати в оренду</span>\n                </button>\n\n                <div class="header__login">\n                <a class="login__link">\n                <span class="login__text">Увійти</span>\n                </a>\n                </div>\n            </div>\n        </div>\n        </header>\n\n        <div class="main container">\n            <div class="main__map">\n                <div id="map"></div>\n            </div>\n            <div class="main__gallery">\n                <div class="form__block"></div>\n                <ul class="item__list"></ul>\n            </div>\n        </div>\n\n        '})),this.root=r}return e(d)(t,[{key:"getRootMap",value:function(){return document.getElementById("map")}},{key:"getButtonToAddNewApartment",value:function(){return document.querySelector(".header__btn")}}]),t}();window.main=function(){var e=new l;e.initModel();var t=new ye(".app");t.initApp();var r=he(t.getRootMap()),n=new ge(".item__list"),i=new ve(".form__block");t.getButtonToAddNewApartment().addEventListener("click",(function(){i.openForm(),n.hideGallery()})),r.addPoints(e.getAllPoints()),r.addEventListener("bounds_changed",(function(t){var r=e.getVisiblePointsId(t);n.showApartments(e.getApartmentsByIdArr(r))}));var o=function(t){e.initBuffer(e.getLastPointId(),t),i.openFormAfterSearch()};i.renderFormToAddNewApartment((function(e){r.findNewPoints({fields:["name","geometry"],query:e}).then(o).catch(i.showErrorSearch)}),(function(t){var r=t.title,o=t.image,s=t.description;e.addApartmentToBuffer({title:r,image:o,description:s}),e.addNewApartment(e.bufferObj),i.hideFormAfterSearch(),i.hideForm(),n.openGallery(),n.showApartments(e.getApartmentById(e.bufferObj.id))}))}}();
//# sourceMappingURL=index.5425bd29.js.map
